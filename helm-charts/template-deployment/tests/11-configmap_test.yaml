suite: ConfigMap 기능 테스트
tests:
  - it: 기본 ConfigMap이 올바르게 생성되어야 함
    template: configmap.yaml
    set:
      templateDefaults:
        web:
          configMap:
            enabled: true
            name: "basic-configmap"
            data:
              default.conf: |
                server {
                  listen 80;
                  server_name localhost;
                }
      templates:
        - name: basic-configmap
          type: web
          image:
            repository: nginx
            tag: "latest"
    asserts:
      - isKind:
          of: ConfigMap
      - equal:
          path: metadata.name
          value: basic-configmap

  - it: 사용자 지정 ConfigMap 이름이 올바르게 적용되어야 함
    template: configmap.yaml
    set:
      templateDefaults:
        web:
          configMap:
            enabled: true
            name: ""
      templates:
        - name: custom-name-configmap
          type: web
          image:
            repository: nginx
            tag: "latest"
          configMap:
            name: "my-custom-config"
            data:
              app.properties: |
                app.name=MyApp
                app.version=1.0.0
    asserts:
      - isKind:
          of: ConfigMap
      - equal:
          path: metadata.name
          value: my-custom-config

  - it: ConfigMap이 비활성화되면 생성되지 않아야 함
    template: configmap.yaml
    set:
      templateDefaults:
        web:
          configMap:
            enabled: false
      templates:
        - name: disabled-configmap
          type: web
          image:
            repository: nginx
            tag: "latest"
    asserts:
      - hasDocuments:
          count: 0 