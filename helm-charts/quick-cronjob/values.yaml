# Default values for quick-cronjob
# This provides a test environment with Ubuntu 22.04

########################################################
# Global Configuration
########################################################
global:
  imageRegistry: ""
  imagePullSecrets: []
  timezone: "UTC"
  storageClass: ""

########################################################
# CronJobs
########################################################
# κΈ°λ³Έμ μΌλ΅ Ubuntu 22.04 ν…μ¤νΈ ν™κ²½ μ κ³µ
jobs:
  # ν…μ¤νΈ/κ°λ°μ© κΈ°λ³Έ ν™κ²½
  test-environment:
    enabled: true

    # CronJob μ„¤μ • (μ‹¤μ λ΅λ” μ‹¤ν–‰λμ§€ μ•μ)
    schedule: "0 0 31 2 *"  # 2μ›” 31μΌ = μ λ€ μ‹¤ν–‰ μ•λ¨
    suspend: true  # CronJob μΌμ‹ μ¤‘μ§€
    timeZone: "UTC"

    # Ubuntu 22.04 μ΄λ―Έμ§€
    image:
      repository: ubuntu
      tag: "22.04"
      pullPolicy: IfNotPresent

    # κΈ°λ³Έ λ…λ Ή (CronJobμ© - μ‹¤μ λ΅λ” μ‹¤ν–‰ μ•λ¨)
    command: ["/bin/bash"]
    args: ["-c", "echo 'Test environment ready'"]

    # ν™κ²½λ³€μ
    env:
      - name: TEST_MODE
        value: "true"
      - name: ENVIRONMENT
        value: "development"

    # ConfigMap - μ μ©ν• μ¤ν¬λ¦½νΈ μ κ³µ
    configMap:
      create: true
      data:
        README.md: |
          # Quick-CronJob Test Environment

          Ubuntu 22.04 ν…μ¤νΈ ν™κ²½μ— μ¤μ‹  κ²ƒμ„ ν™μν•©λ‹λ‹¤!

          ## μ ‘μ† λ°©λ²•:
          kubectl exec -it deploy/[release-name]-test-environment-test -- bash

          ## μ‚¬μ© κ°€λ¥ν• λ„κµ¬:
          - bash, sh
          - python3
          - κΈ°λ³Έ Linux μ ν‹Έλ¦¬ν‹°

          ## λ„κµ¬ μ„¤μΉ:
          /scripts/install-tools.sh μ‹¤ν–‰

          ## μμ  μ¤ν¬λ¦½νΈ:
          - /scripts/test-db-connection.sh
          - /scripts/test-api-call.sh
          - /scripts/test-file-operations.sh

        install-tools.sh: |
          #!/bin/bash
          echo "=== μ μ©ν• λ„κµ¬ μ„¤μΉ μ¤‘... ==="

          apt-get update > /dev/null 2>&1
          apt-get install -y \
            curl \
            wget \
            vim \
            net-tools \
            dnsutils \
            postgresql-client \
            mysql-client \
            redis-tools \
            jq \
            git \
            python3-pip \
            htop > /dev/null 2>&1

          echo "β… λ„κµ¬ μ„¤μΉ μ™„λ£!"
          echo ""
          echo "μ„¤μΉλ λ„κµ¬:"
          echo "- curl, wget: HTTP ν΄λΌμ΄μ–ΈνΈ"
          echo "- vim: ν…μ¤νΈ μ—λ””ν„°"
          echo "- postgresql-client: PostgreSQL ν΄λΌμ΄μ–ΈνΈ"
          echo "- mysql-client: MySQL ν΄λΌμ΄μ–ΈνΈ"
          echo "- redis-tools: Redis ν΄λΌμ΄μ–ΈνΈ"
          echo "- jq: JSON μ²λ¦¬κΈ°"
          echo "- python3-pip: Python ν¨ν‚¤μ§€ κ΄€λ¦¬μ"

        test-db-connection.sh: |
          #!/bin/bash
          echo "=== λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° ν…μ¤νΈ ==="
          echo "PostgreSQL μ—°κ²° ν…μ¤νΈ μμ :"
          echo "psql \$DATABASE_URL -c 'SELECT version();'"
          echo ""
          echo "MySQL μ—°κ²° ν…μ¤νΈ μμ :"
          echo "mysql -h \$DB_HOST -u \$DB_USER -p\$DB_PASSWORD -e 'SELECT VERSION();'"
          echo ""
          echo "Redis μ—°κ²° ν…μ¤νΈ μμ :"
          echo "redis-cli -h \$REDIS_HOST ping"
          echo ""
          echo "ν™κ²½λ³€μλ¥Ό μ„¤μ •ν•κ³  μ‹¤μ  λ…λ Ήμ„ μ‹¤ν–‰ν•μ„Έμ”."

        test-api-call.sh: |
          #!/bin/bash
          echo "=== API νΈμ¶ ν…μ¤νΈ ==="
          echo "HTTP GET μ”μ²­ μμ :"
          echo "curl -s https://httpbin.org/get | jq"
          echo ""
          echo "HTTP POST μ”μ²­ μμ :"
          echo "curl -s -X POST -H 'Content-Type: application/json' \\"
          echo "  -d '{\"key\": \"value\"}' \\"
          echo "  https://httpbin.org/post | jq"
          echo ""
          echo "μ‹¤μ  API μ—”λ“ν¬μΈνΈλ΅ ν…μ¤νΈν•΄λ³΄μ„Έμ”."

        test-file-operations.sh: |
          #!/bin/bash
          echo "=== νμΌ μ‘μ—… ν…μ¤νΈ ==="
          echo "μ‘μ—… λ””λ ‰ν† λ¦¬: $(pwd)"
          echo "λ””μ¤ν¬ μ‚¬μ©λ‰:"
          df -h
          echo ""
          echo "λ©”λ¨λ¦¬ μ‚¬μ©λ‰:"
          free -h
          echo ""
          echo "μ„μ‹ νμΌ μƒμ„± ν…μ¤νΈ:"
          echo "Hello from Quick-CronJob!" > /tmp/test.txt
          cat /tmp/test.txt
          rm /tmp/test.txt
          echo "β… νμΌ μ‘μ—… ν…μ¤νΈ μ™„λ£"

    # ν…μ¤νΈ Deployment ν™μ„±ν™”
    testDeployment:
      enabled: true
      installTools: false  # μλ™ μ„¤μΉλ΅ λ³€κ²½
      welcomeMessage: |
        ========================================
        Quick-CronJob ν…μ¤νΈ ν™κ²½μ— μ¤μ‹  κ²ƒμ„ ν™μν•©λ‹λ‹¤!
        ========================================

        π§ Ubuntu 22.04 κ°λ° ν™κ²½

        λΉ λ¥Έ μ‹μ‘:
        1. λ„κµ¬ μ„¤μΉ: /scripts/install-tools.sh
        2. μμ  μ¤ν¬λ¦½νΈ ν™•μΈ: ls /scripts/
        3. λ¬Έμ„ μ½κΈ°: cat /scripts/README.md

        CronJob μ¤ν¬λ¦½νΈλ¥Ό ν…μ¤νΈν•κ³  κ°λ°ν•μ„Έμ”!
        ========================================